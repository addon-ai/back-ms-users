@startuml Hexagonal Architecture - Complete Structure
!theme plain
title Generated Hexagonal Architecture - Complete Structure

package "External Actors" {
    actor "Web Client" as WebClient
    actor "Mobile App" as MobileApp
    actor "API Consumer" as APIConsumer
    database "H2 Database" as Database
    queue "Message Queue" as Queue
}

package "Infrastructure Layer (Adapters)" {
    package "Input Adapters" {
        component "UserController" as UserCtrl
        component "LocationController" as LocationCtrl
        component "MovieController" as MovieCtrl
        component "RentalController" as RentalCtrl
        note right of UserCtrl : REST endpoints\nHTTP request handling\nValidation & serialization
    }
    
    package "Output Adapters" {
        package "Persistence Adapters" {
            component "UserRepositoryAdapter" as UserRepoAdapter
            component "LocationRepositoryAdapter" as LocationRepoAdapter
            component "MovieRepositoryAdapter" as MovieRepoAdapter
            component "RentalRepositoryAdapter" as RentalRepoAdapter
        }
        
        package "JPA Repositories" {
            component "JpaUserRepository" as UserJpaRepo
            component "JpaLocationRepository" as LocationJpaRepo
            component "JpaMovieRepository" as MovieJpaRepo
            component "JpaRentalRepository" as RentalJpaRepo
        }
        
        package "JPA Entities" {
            component "UserDbo" as UserDbo
            component "LocationDbo" as LocationDbo
            component "MovieDbo" as MovieDbo
            component "RentalDbo" as RentalDbo
        }
    }
    
    package "Configuration" {
        component "ApplicationConfiguration" as AppConfig
        component "SecurityConfiguration" as SecurityConfig
        component "OpenApiConfiguration" as OpenApiConfig
        component "GlobalExceptionHandler" as ExceptionHandler
    }
}

package "Application Layer (Use Case Implementations)" {
    package "Services" {
        component "UserService" as UserService
        component "LocationService" as LocationService
        component "MovieService" as MovieService
        component "RentalService" as RentalService
        note right of UserService : Consolidated use case\nimplementations\nBusiness logic orchestration
    }
    
    package "Mappers" {
        component "UserMapper" as UserMapper
        component "LocationMapper" as LocationMapper
        component "MovieMapper" as MovieMapper
        component "RentalMapper" as RentalMapper
        note right of UserMapper : MapStruct mappers\nDTO ↔ Domain ↔ DBO\nData transformation
    }
    
    package "DTOs" {
        package "User DTOs" {
            component "CreateUserRequestContent" as CreateUserReq
            component "GetUserResponseContent" as GetUserResp
            component "UpdateUserRequestContent" as UpdateUserReq
            component "ListUsersResponseContent" as ListUsersResp
        }
        
        package "Location DTOs" {
            component "CreateLocationRequestContent" as CreateLocationReq
            component "GetRegionsByCountryResponseContent" as GetRegionsResp
            component "GetCitiesByRegionResponseContent" as GetCitiesResp
        }
        
        package "Movie DTOs" {
            component "CreateMovieRequestContent" as CreateMovieReq
            component "CreateRentalRequestContent" as CreateRentalReq
        }
    }
    
    package "Utilities" {
        component "LoggingUtils" as LoggingUtils
        note right of LoggingUtils : MDC context management\nStructured logging\nRequest tracing
    }
}

package "Domain Layer (Business Logic)" {
    package "Domain Models" {
        component "User" as UserModel
        component "Location" as LocationModel
        component "Movie" as MovieModel
        component "Rental" as RentalModel
        component "EntityStatus" as EntityStatus
        note right of UserModel : Pure domain objects\nNo framework dependencies\nBusiness logic
    }
    
    package "Input Ports (Use Cases)" {
        interface "UserUseCase" as UserUseCase
        interface "LocationUseCase" as LocationUseCase
        interface "MovieUseCase" as MovieUseCase
        interface "RentalUseCase" as RentalUseCase
        note right of UserUseCase : Consolidated interfaces\nCRUD + complex operations\nDomain contracts
    }
    
    package "Output Ports (Repository Interfaces)" {
        interface "UserRepositoryPort" as UserRepoPort
        interface "LocationRepositoryPort" as LocationRepoPort
        interface "MovieRepositoryPort" as MovieRepoPort
        interface "RentalRepositoryPort" as RentalRepoPort
        note right of UserRepoPort : Repository contracts\nData access abstraction\nDomain-driven queries
    }
}

' External connections
WebClient --> UserCtrl : HTTP/REST
MobileApp --> LocationCtrl : HTTP/REST
APIConsumer --> MovieCtrl : HTTP/REST

' Input Adapter connections
UserCtrl --> UserUseCase : implements
LocationCtrl --> LocationUseCase : implements
MovieCtrl --> MovieUseCase : implements
RentalCtrl --> RentalUseCase : implements

' Application Layer connections
UserService ..|> UserUseCase : implements
LocationService ..|> LocationUseCase : implements
MovieService ..|> MovieUseCase : implements
RentalService ..|> RentalUseCase : implements

UserService --> UserRepoPort : uses
LocationService --> LocationRepoPort : uses
MovieService --> MovieRepoPort : uses
RentalService --> RentalRepoPort : uses

UserService --> UserMapper : uses
LocationService --> LocationMapper : uses
MovieService --> MovieMapper : uses
RentalService --> RentalMapper : uses

' Output Adapter connections
UserRepoAdapter ..|> UserRepoPort : implements
LocationRepoAdapter ..|> LocationRepoPort : implements
MovieRepoAdapter ..|> MovieRepoPort : implements
RentalRepoAdapter ..|> RentalRepoPort : implements

UserRepoAdapter --> UserJpaRepo : uses
LocationRepoAdapter --> LocationJpaRepo : uses
MovieRepoAdapter --> MovieJpaRepo : uses
RentalRepoAdapter --> RentalJpaRepo : uses

UserRepoAdapter --> UserMapper : uses
LocationRepoAdapter --> LocationMapper : uses
MovieRepoAdapter --> MovieMapper : uses
RentalRepoAdapter --> RentalMapper : uses

' JPA connections
UserJpaRepo --> UserDbo : manages
LocationJpaRepo --> LocationDbo : manages
MovieJpaRepo --> MovieDbo : manages
RentalJpaRepo --> RentalDbo : manages

UserJpaRepo --> Database : persists
LocationJpaRepo --> Database : persists
MovieJpaRepo --> Database : persists
RentalJpaRepo --> Database : persists

' Domain Model relationships
UserModel --> EntityStatus : uses
LocationModel --> EntityStatus : uses
MovieModel --> EntityStatus : uses
RentalModel --> EntityStatus : uses

' Configuration connections
ExceptionHandler --> UserCtrl : handles
ExceptionHandler --> LocationCtrl : handles
ExceptionHandler --> MovieCtrl : handles
ExceptionHandler --> RentalCtrl : handles

' Logging connections
UserService --> LoggingUtils : uses
LocationService --> LoggingUtils : uses
MovieService --> LoggingUtils : uses
RentalService --> LoggingUtils : uses

UserCtrl --> LoggingUtils : uses
LocationCtrl --> LoggingUtils : uses
MovieCtrl --> LoggingUtils : uses
RentalCtrl --> LoggingUtils : uses

note as ArchNote
**Hexagonal Architecture Principles:**
• **Dependency Rule**: All dependencies point inward toward domain
• **Ports & Adapters**: External communication through well-defined interfaces
• **Domain Isolation**: Pure business logic without framework dependencies
• **Testability**: Each layer can be tested independently
• **Flexibility**: Easy to swap implementations (database, web framework, etc.)

**Generated Components:**
• **2 Microservices**: User Service, Movie Service
• **6 Domain Entities**: User, Location, Movie, Rental, City, Country, Region, Neighborhood
• **Complete CRUD Operations**: Create, Read, Update, Delete for all entities
• **Complex Operations**: Geographic queries, rental management
• **Comprehensive Testing**: 100% code coverage including edge cases
end note

@enduml